# 项目部署说明

## 📦 依赖管理

### 🧹 依赖清理
项目已经过优化，删除了不必要的依赖：

- **清理前**: ~292 MB (49,295 个文件)
- **清理后**: ~4.18 MB (60 个文件)
- **节省空间**: ~98.6%

### 📋 实际使用的依赖
项目中实际使用的依赖：

**生产依赖 (dependencies)**:
- `@supabase/supabase-js` - 数据库客户端 (Netlify Functions 需要)
- `alipay-sdk` - 支付宝支付SDK (Netlify Functions 需要)
- `resend` - 邮件发送服务 (Netlify Functions 需要)

**开发依赖 (devDependencies)**:
- `netlify-cli` - 本地开发服务器

## 🚀 部署流程

### 1. 本地开发
```bash
# 安装开发依赖
npm run install:dev

# 启动本地开发服务器
npm run dev
```

### 2. 清理项目
```bash
# 清理不需要的文件
npm run clean
```

### 3. Netlify 部署
1. 将代码推送到 GitHub
2. 在 Netlify 中连接仓库
3. 构建命令：`npm install` (安装所有依赖，包括 Netlify Functions 需要的依赖)
4. 发布目录：`/` (根目录)

## 📁 文件结构

### ✅ 需要提交的文件
- `netlify/functions/` - Netlify Functions
- `assets/` - 静态资源
- `*.html` - 页面文件
- `package.json` - 项目配置
- `netlify.toml` - Netlify 配置

### ❌ 不需要提交的文件 (已在 .gitignore 中)
- `node_modules/` - 依赖包
- `package-lock.json` - 锁定文件
- `.netlify/` - 本地开发缓存
- `.env` - 环境变量

## 🔧 环境变量配置

在 Netlify 中需要配置以下环境变量：
- `SUPABASE_URL` - Supabase 数据库 URL
- `SUPABASE_ANON_KEY` - Supabase 匿名密钥
- `ALIPAY_APP_ID` - 支付宝应用 ID
- `ALIPAY_PRIVATE_KEY` - 支付宝私钥
- `RESEND_API_KEY` - Resend 邮件服务密钥

## 📊 部署优势

1. **体积小**: 项目文件从 292MB 减少到 4.18MB
2. **部署快**: 减少了 98.6% 的文件传输时间
3. **维护简单**: 只保留必要的依赖
4. **成本低**: 减少存储和带宽成本

## ⚠️ 重要说明

### Netlify Functions 依赖
- Netlify Functions 需要 `dependencies` 中的包才能正常工作
- 这些依赖会在部署时自动安装到 Netlify 环境中
- 不要删除 `dependencies` 中的包，否则会导致部署失败

### 依赖分类
- **dependencies**: 生产环境需要的包 (Netlify Functions 使用)
- **devDependencies**: 仅开发环境需要的包 (本地开发使用)

## 🛠️ 故障排除

### 如果本地开发出现问题
```bash
# 重新安装依赖
npm run clean
npm run install:dev
```

### 如果部署失败
1. 检查 Netlify 构建日志
2. 确认环境变量配置正确
3. 检查 Node.js 版本 (需要 >= 16.0.0)
