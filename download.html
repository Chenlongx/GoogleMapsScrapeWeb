<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‹è½½ä¸­å¿ƒ | æ™ºè´¸äº‘æ¢¯ - è·å–æ‰€æœ‰äº§å“</title>
    <meta name="description"
        content="ä¸‹è½½æ™ºè´¸äº‘æ¢¯å…¨ç³»åˆ—äº§å“ï¼šGoogle Maps Scraperã€MediaMingleã€MailProã€WhatsApp Validatorã€‚æ”¯æŒ Windows å’Œ macOSã€‚">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="./assets/js/main.js" defer></script>
</head>
<style>
    /* --- 9. ä¸‹è½½é¡µé¢æ ·å¼ --- */
    .download-section {
        padding: 5rem 0;
        background-color: var(--background-color);
    }

    /* äº§å“ç½‘æ ¼å¸ƒå±€ - ç»Ÿä¸€çš„å¡ç‰‡ç½‘æ ¼ */
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 2rem;
        margin-bottom: 4rem;
    }

    /* äº§å“å¡ç‰‡ */
    .product-download-card {
        background-color: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .product-download-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    html[data-theme="dark"] .product-download-card:hover {
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    /* äº§å“å¤´éƒ¨ */
    .product-header {
        text-align: center;
        margin-bottom: 1.5rem;
    }

    .product-icon {
        font-size: 3.5rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
    }

    .product-header h3 {
        font-size: 1.4rem;
        color: var(--text-primary-color);
        margin-bottom: 0.5rem;
        line-height: 1.3;
    }

    .product-subtitle {
        color: var(--text-secondary-color);
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }

    /* å¹³å°ä¸‹è½½é€‰é¡¹ */
    .platform-options {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-top: auto;
    }

    .platform-item {
        background-color: var(--background-color);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 1rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
    }

    .platform-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex: 1;
    }

    .platform-info i {
        font-size: 1.8rem;
        color: var(--primary-color);
    }

    .platform-details {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .platform-name {
        font-weight: 600;
        color: var(--text-primary-color);
        font-size: 0.95rem;
    }

    .version-info {
        color: var(--text-secondary-color);
        font-size: 0.8rem;
    }

    .platform-action {
        flex-shrink: 0;
    }

    .platform-action .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        white-space: nowrap;
    }

    .platform-action .btn i {
        font-size: 1.1rem;
    }

    /* ç¦ç”¨æŒ‰é’®æ ·å¼ */
    .btn.disabled {
        background-color: #94a3b8;
        background-image: none;
        cursor: not-allowed;
        opacity: 0.6;
    }

    .btn.disabled:hover {
        transform: none;
    }

    html[data-theme="dark"] .btn.disabled {
        background-color: #475569;
    }

    /* ä¸‹è½½å®‰å…¨æç¤ºæ ·å¼ */
    .download-safety-notice {
        background-color: var(--surface-color);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1.5rem;
        margin: 3rem auto;
        max-width: 900px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .download-safety-notice h3 {
        font-size: 1.2rem;
        color: var(--text-primary-color);
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .download-safety-notice h3 i {
        color: #f59e0b;
        font-size: 1.5rem;
    }

    .download-safety-notice ul {
        margin: 1rem 0;
        padding-left: 1.5rem;
        color: var(--text-secondary-color);
        line-height: 1.8;
    }

    .download-safety-notice li {
        margin: 0.5rem 0;
    }

    .download-safety-notice strong {
        color: var(--text-primary-color);
    }

    .release-notes {
        text-align: center;
        margin-top: 4rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border-color);
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 767px) {
        .products-grid {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .platform-item {
            flex-direction: column;
            text-align: center;
        }

        .platform-info {
            flex-direction: column;
            text-align: center;
        }

        .platform-action .btn {
            width: 100%;
        }
    }

    @media (min-width: 768px) and (max-width: 1023px) {
        .products-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (min-width: 1024px) {
        .products-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    @media (min-width: 1400px) {
        .products-grid {
            grid-template-columns: repeat(4, 1fr);
        }
    }
</style>

<body>
    <div id="notification-banner" class="notification-banner" role="alert" aria-live="assertive"></div>
    <header id="main-header" class="main-header"></header>

    <main>
        <section class="page-header">
            <div class="container">
                <h1 data-lang-zh="ä¸‹è½½ä¸­å¿ƒ" data-lang-en="Download Center"></h1>
                <p data-lang-zh="è·å–é€‚ç”¨äºæ‚¨æ“ä½œç³»ç»Ÿçš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ”¯æŒ Windows ä¸ macOSã€‚"
                    data-lang-en="Get the latest version for your operating system. Windows and macOS supported."></p>
            </div>
        </section>

        <section class="download-section">
            <div class="container">

                <!-- ä¸‹è½½æç¤ºï¼šé‚®ç®±æ³¨å†Œå³å¯å…è´¹è¯•ç”¨ -->
                <p class="section-subtitle"
                    style="text-align:center; margin-bottom: 2rem; color: var(--text-secondary-color);"
                    data-lang-zh="ä½¿ç”¨é‚®ç®±æ³¨å†Œè´¦å·å³å¯è·å¾—å…è´¹è¯•ç”¨èµ„æ ¼ï¼Œå…ˆä½“éªŒå†å†³å®šæ˜¯å¦å‡çº§ä»˜è´¹ç‰ˆæœ¬ã€‚"
                    data-lang-en="Sign up with your email to start a free trial first, then decide whether to upgrade to a paid plan.">
                </p>

                <!-- äº§å“ç½‘æ ¼ -->
                <div class="products-grid">

                    <!-- è°·æ­Œåœ°å›¾æŠ“å–å™¨ -->
                    <div class="product-download-card">
                        <div class="product-header">
                            <i class='bx bxs-map-alt product-icon'></i>
                            <h3 data-lang-zh="è°·æ­Œåœ°å›¾æŠ“å–å™¨" data-lang-en="Google Maps Scraper"></h3>
                            <p class="product-subtitle" data-lang-zh="ä»Google Mapsç²¾å‡†æå–å•†å®¶ä¿¡æ¯"
                                data-lang-en="Extract business info from Google Maps"></p>
                        </div>
                        <div class="platform-options">
                            <div class="platform-item" id="gs-windows-card">
                                <div class="platform-info">
                                    <i class='bx bxl-windows'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="Windows"
                                            data-lang-en="Windows"></span>
                                        <span class="version-info" data-lang-zh="æ­£åœ¨è·å–ç‰ˆæœ¬..."
                                            data-lang-en="Fetching..."></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
                                        <i class='bx bxs-download'></i>
                                        <span data-lang-zh="ä¸‹è½½" data-lang-en="Download"></span>
                                    </a>
                                </div>
                            </div>
                            <div class="platform-item" id="gs-macos-card">
                                <div class="platform-info">
                                    <i class='bx bxl-apple'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="macOS" data-lang-en="macOS"></span>
                                        <span class="version-info" data-lang-zh="æ•¬è¯·æœŸå¾…"
                                            data-lang-en="Coming Soon"></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-secondary disabled">
                                        <i class='bx bx-time'></i>
                                        <span data-lang-zh="æ•¬è¯·æœŸå¾…" data-lang-en="Soon"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MediaMingle ä¸“ä¸šç‰ˆ -->
                    <div class="product-download-card">
                        <div class="product-header">
                            <i class='bx bx-search-alt product-icon'></i>
                            <h3 data-lang-zh="ç»¼åˆæœå¼•æ“ä¸“ä¸šç‰ˆ" data-lang-en="MediaMingle Pro"></h3>
                            <p class="product-subtitle" data-lang-zh="ç»¼åˆæœç´¢å¼•æ“é‚®ä»¶æŒ–æ˜å·¥å…·"
                                data-lang-en="Search engine email mining tool"></p>
                        </div>
                        <div class="platform-options">
                            <div class="platform-item" id="mm-windows-card">
                                <div class="platform-info">
                                    <i class='bx bxl-windows'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="Windows"
                                            data-lang-en="Windows"></span>
                                        <span class="version-info" data-lang-zh="æ­£åœ¨è·å–ç‰ˆæœ¬..."
                                            data-lang-en="Fetching..."></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
                                        <i class='bx bxs-download'></i>
                                        <span data-lang-zh="ä¸‹è½½" data-lang-en="Download"></span>
                                    </a>
                                </div>
                            </div>
                            <div class="platform-item" id="mm-macos-card">
                                <div class="platform-info">
                                    <i class='bx bxl-apple'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="macOS" data-lang-en="macOS"></span>
                                        <span class="version-info" data-lang-zh="æ•¬è¯·æœŸå¾…"
                                            data-lang-en="Coming Soon"></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-secondary disabled">
                                        <i class='bx bx-time'></i>
                                        <span data-lang-zh="æ•¬è¯·æœŸå¾…" data-lang-en="Soon"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MailPro é‚®ä»¶è¥é”€å¤§å¸ˆ -->
                    <div class="product-download-card">
                        <div class="product-header">
                            <i class='bx bxs-check-shield product-icon'></i>
                            <h3 data-lang-zh="é‚®ä»¶è¥é”€å¤§å¸ˆ" data-lang-en="MailPro Email Master"></h3>
                            <p class="product-subtitle" data-lang-zh="ä¸“ä¸šé‚®ç®±éªŒè¯ä¸è¥é”€ç³»ç»Ÿ"
                                data-lang-en="Email validation & marketing"></p>
                        </div>
                        <div class="platform-options">
                            <div class="platform-item" id="ev-windows-card">
                                <div class="platform-info">
                                    <i class='bx bxl-windows'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="Windows"
                                            data-lang-en="Windows"></span>
                                        <span class="version-info" data-lang-zh="æ­£åœ¨è·å–ç‰ˆæœ¬..."
                                            data-lang-en="Fetching..."></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
                                        <i class='bx bxs-download'></i>
                                        <span data-lang-zh="ä¸‹è½½" data-lang-en="Download"></span>
                                    </a>
                                </div>
                            </div>
                            <div class="platform-item" id="ev-macos-card">
                                <div class="platform-info">
                                    <i class='bx bxl-apple'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="macOS" data-lang-en="macOS"></span>
                                        <span class="version-info" data-lang-zh="æ•¬è¯·æœŸå¾…"
                                            data-lang-en="Coming Soon"></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-secondary disabled">
                                        <i class='bx bx-time'></i>
                                        <span data-lang-zh="æ•¬è¯·æœŸå¾…" data-lang-en="Soon"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- WhatsAppå·ç éªŒè¯å™¨ -->
                    <div class="product-download-card">
                        <div class="product-header">
                            <i class='bx bxl-whatsapp-square product-icon'></i>
                            <h3 data-lang-zh="WhatsAppå·ç éªŒè¯å™¨" data-lang-en="WhatsApp Validator"></h3>
                            <p class="product-subtitle" data-lang-zh="æ‰¹é‡éªŒè¯WhatsAppå·ç çœŸå®æ€§"
                                data-lang-en="Bulk validate WhatsApp numbers"></p>
                        </div>
                        <div class="platform-options">
                            <div class="platform-item" id="wv-windows-card">
                                <div class="platform-info">
                                    <i class='bx bxl-windows'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="Windows"
                                            data-lang-en="Windows"></span>
                                        <span class="version-info" data-lang-zh="æ­£åœ¨è·å–ç‰ˆæœ¬..."
                                            data-lang-en="Fetching..."></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-primary" target="_blank" rel="noopener noreferrer">
                                        <i class='bx bxs-download'></i>
                                        <span data-lang-zh="ä¸‹è½½" data-lang-en="Download"></span>
                                    </a>
                                </div>
                            </div>
                            <div class="platform-item" id="wv-macos-card">
                                <div class="platform-info">
                                    <i class='bx bxl-apple'></i>
                                    <div class="platform-details">
                                        <span class="platform-name" data-lang-zh="macOS" data-lang-en="macOS"></span>
                                        <span class="version-info" data-lang-zh="æ•¬è¯·æœŸå¾…"
                                            data-lang-en="Coming Soon"></span>
                                    </div>
                                </div>
                                <div class="platform-action">
                                    <a href="#" class="btn btn-secondary disabled">
                                        <i class='bx bx-time'></i>
                                        <span data-lang-zh="æ•¬è¯·æœŸå¾…" data-lang-en="Soon"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>


                <!-- ä¸‹è½½å®‰å…¨æç¤º -->
                <div class="download-safety-notice">
                    <h3>
                        <i class='bx bx-info-circle'></i>
                        <span data-lang-zh="å¦‚æœæµè§ˆå™¨é˜»æ­¢ä¸‹è½½ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œ"
                            data-lang-en="If your browser blocks the download, please follow these steps"></span>
                    </h3>
                    <ul>
                        <li data-lang-zh="<strong>Microsoft Edge/Chromeï¼š</strong> ç‚¹å‡»ä¸‹è½½æŒ‰é’®åï¼Œå¦‚æœçœ‹åˆ°é˜»æ­¢æç¤ºï¼Œè¯·ç‚¹å‡»æµè§ˆå™¨åœ°å€æ å³ä¾§çš„ã€ä¸‹è½½å·²é˜»æ­¢ã€æˆ–ã€æŸ¥çœ‹ä¸‹è½½ã€ï¼Œç„¶åé€‰æ‹©ã€ä¿ç•™ã€æˆ–ã€å…è®¸ä¸‹è½½ã€ã€‚"
                            data-lang-en="<strong>Microsoft Edge/Chrome:</strong> After clicking the download button, if you see a blocking message, click 'Downloads blocked' or 'View downloads' in the browser address bar, then select 'Keep' or 'Allow download'.">
                        </li>
                        <li data-lang-zh="<strong>Windows å®‰å…¨ä¸­å¿ƒï¼š</strong> å¦‚æœ Windows Defender SmartScreen æç¤ºã€ä¸å¸¸è§çš„ä¸‹è½½ã€ï¼Œè¯·ç‚¹å‡»ã€æ›´å¤šä¿¡æ¯ã€ï¼Œç„¶åé€‰æ‹©ã€ä»è¦è¿è¡Œã€ã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•ä¸ºæ‰€æœ‰ä¸‹è½½æä¾›æ•°å­—ç­¾åã€‚"
                            data-lang-en="<strong>Windows Security:</strong> If Windows Defender SmartScreen shows 'Uncommon download', click 'More info' then select 'Run anyway'. This is normal as we cannot provide digital signatures for all downloads.">
                        </li>
                        <li data-lang-zh="<strong>ä»ç„¶æ— æ³•ä¸‹è½½ï¼Ÿ</strong> å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š<br>1. æŒ‰ä½ <strong>Ctrl</strong> é”®ç‚¹å‡»ä¸‹è½½æŒ‰é’® â†’ ä½¿ç”¨ GitHub ç›´æ¥é“¾æ¥<br>2. æŒ‰ä½ <strong>Shift</strong> é”®ç‚¹å‡»ä¸‹è½½æŒ‰é’® â†’ ä½¿ç”¨å¤–éƒ¨ä»£ç†é“¾æ¥<br>3. å³é”®ç‚¹å‡»ä¸‹è½½æŒ‰é’® â†’ é€‰æ‹©ã€åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥ã€<br>4. <strong>æ‰€æœ‰äº§å“</strong> â†’ ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸ºä¸­å›½ç”¨æˆ·æä¾›è“å¥äº‘å¤‡ç”¨ä¸‹è½½é“¾æ¥<br>5. è”ç³»å®¢æœè·å–ä¸‹è½½é“¾æ¥"
                            data-lang-en="<strong>Still can't download?</strong> Try these methods:<br>1. Hold <strong>Ctrl</strong> and click â†’ Use direct GitHub link<br>2. Hold <strong>Shift</strong> and click â†’ Use external proxy link<br>3. Right-click the button â†’ Select 'Open link in new tab'<br>4. <strong>All Products</strong> â†’ Backup download links available for Chinese users<br>5. Contact customer service for download link">
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer id="main-footer" class="main-footer"></footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const GITHUB_USERNAME = 'Chenlongx';
            // åŠ¨æ€æ£€æµ‹ç¯å¢ƒå¹¶è®¾ç½® API åŸºç¡€ URL
            const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            const API_BASE_URL = isLocal ? '/.netlify/functions/github/' : '/api/github/';

            // ç¼“å­˜é…ç½® - ç¼“å­˜ 1 å°æ—¶
            const CACHE_DURATION = 60 * 60 * 1000; // 1å°æ—¶ï¼ˆæ¯«ç§’ï¼‰

            /**
             * ä»ç¼“å­˜ä¸­è·å–æ•°æ®
             * @param {string} key - ç¼“å­˜é”®
             * @returns {object|null} - ç¼“å­˜çš„æ•°æ®æˆ– null
             */
            function getCache(key) {
                try {
                    const cached = localStorage.getItem(key);
                    if (!cached) return null;

                    const { data, timestamp } = JSON.parse(cached);
                    const now = Date.now();

                    // æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ
                    if (now - timestamp > CACHE_DURATION) {
                        localStorage.removeItem(key);
                        return null;
                    }

                    console.log(`âœ… ä½¿ç”¨ç¼“å­˜æ•°æ®: ${key}, ç¼“å­˜äº ${new Date(timestamp).toLocaleString()}`);
                    return data;
                } catch (e) {
                    console.error('è¯»å–ç¼“å­˜å¤±è´¥:', e);
                    return null;
                }
            }

            /**
             * ä¿å­˜æ•°æ®åˆ°ç¼“å­˜
             * @param {string} key - ç¼“å­˜é”®
             * @param {object} data - è¦ç¼“å­˜çš„æ•°æ®
             */
            function setCache(key, data) {
                try {
                    const cacheData = {
                        data: data,
                        timestamp: Date.now()
                    };
                    localStorage.setItem(key, JSON.stringify(cacheData));
                    console.log(`ğŸ’¾ å·²ç¼“å­˜æ•°æ®: ${key}`);
                } catch (e) {
                    console.error('ä¿å­˜ç¼“å­˜å¤±è´¥:', e);
                }
            }

            /**
             * ä» GitHub è·å–äº§å“å‘å¸ƒä¿¡æ¯ï¼Œå¹¶å¸¦æœ‰å¤±è´¥é‡è¯•é€»è¾‘å’Œç¼“å­˜
             * @param {object} config - äº§å“é…ç½®å¯¹è±¡
             */
            function fetchProductRelease(config) {
                // ä¸å†ä½¿ç”¨ä¸ç¨³å®šçš„ç¬¬ä¸‰æ–¹é•œåƒï¼Œæ”¹ä¸ºæ ¹æ®ç”¨æˆ·åœ°åŒºä½¿ç”¨ä¸åŒç­–ç•¥
                const apiUrl = `${API_BASE_URL}${GITHUB_USERNAME}/${config.repoName}/releases/latest`;

                // å¤‡ç”¨ä¸‹è½½é“¾æ¥æ˜ å°„è¡¨ï¼ˆè“å¥äº‘ç­‰å›½å†…å¯è®¿é—®çš„é“¾æ¥ï¼‰
                const backupDownloadUrls = {
                    'gogole_maps': 'https://small4.bakstotre.com/202512021218/6b547a1629c25d4b5b8dc74c949c5c2f/disk/2025/12/02/23244306/23244306/11764649004776.rar',
                    'mediamingle_pro_repo': 'https://small4.bakstotre.com/202511201418/3400d6dca86119eff410e3164fe33a62/disk/2025/11/17/23244306/51763372457412.rar',
                    'email_validator_repo': 'https://small4.bakstotre.com/202511201419/59bc8c8a401fb4e1b9414df0291f8a36/disk/2025/11/17/23244306/91763372625244.rar',
                    'whatsapp_validator_repo': 'https://small4.bakstotre.com/202511201420/7972936f196c80a1b2c8980518ce4389/disk/2025/11/17/23244306/131763372830386.rar'
                };

                // --- é‡è¯•é€»è¾‘ç›¸å…³é…ç½® ---
                const MAX_RETRIES = 3; // æœ€å¤§é‡è¯•æ¬¡æ•°
                const INITIAL_DELAY = 2000; // åˆå§‹é‡è¯•å»¶è¿Ÿï¼ˆ2ç§’ï¼‰

                // --- UI å…ƒç´ è·å– (é€‚é…æ–°ç»“æ„) ---
                const macosCard = document.getElementById(config.macosCardId);
                if (macosCard) {
                    const macosBtn = macosCard.querySelector('.btn');
                    if (macosBtn) {
                        macosBtn.addEventListener('click', e => {
                            e.preventDefault();
                            alert('macOS ç‰ˆæœ¬å³å°†æ¨å‡ºï¼Œæ•¬è¯·æœŸå¾…ï¼');
                        });
                    }
                }

                const windowsCard = document.getElementById(config.windowsCardId);
                if (!windowsCard) return;

                const windowsVersionInfo = windowsCard.querySelector('.version-info');
                const windowsDownloadBtn = windowsCard.querySelector('.platform-action .btn');

                // ç”Ÿæˆç¼“å­˜é”®
                const cacheKey = `github_release_${config.repoName}`;

                /**
                 * æ›´æ–°UIçš„å‡½æ•°ï¼Œå¯å¤ç”¨äºç¼“å­˜æ•°æ®å’Œæ–°è·å–çš„æ•°æ®
                 */
                function updateUIWithReleaseData(data, versionInfo, downloadBtn) {
                    if (!data.tag_name) throw new Error('No release found');

                    const version = data.tag_name;
                    const publishedDate = new Date(data.published_at).toLocaleDateString();
                    const versionTextZh = `ç‰ˆæœ¬ ${version.replace('v', '')} | ${publishedDate}`;
                    const versionTextEn = `Version ${version.replace('v', '')} | ${publishedDate}`;

                    // ä¼˜å…ˆé€‰æ‹©å‹ç¼©åŒ…
                    const asset = data.assets.find(asset =>
                        asset.name.endsWith('.exe') ||
                        asset.name.toLowerCase().includes('win')
                    ) || data.assets.find(asset =>
                        asset.name.endsWith('.zip') ||
                        asset.name.endsWith('.rar') ||
                        asset.name.endsWith('.7z')
                    );

                    if (asset) {
                        versionInfo.setAttribute('data-lang-zh', versionTextZh);
                        versionInfo.setAttribute('data-lang-en', versionTextEn);

                        const currentLang = document.documentElement.lang || 'zh';
                        versionInfo.textContent = (currentLang.startsWith('zh')) ? versionTextZh : versionTextEn;

                        // æ£€æµ‹ç”¨æˆ·åœ°åŒº
                        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                        const isChina = timezone.includes('Asia/Shanghai') ||
                            timezone.includes('Asia/Beijing') ||
                            navigator.language.includes('zh');

                        let finalDownloadUrl;
                        let backupUrl = backupDownloadUrls[config.repoName];

                        if (isChina && backupUrl) {
                            // å›½å†…ç”¨æˆ·ï¼šä¼˜å…ˆä½¿ç”¨è“å¥äº‘ç­‰å›½å†…é“¾æ¥
                            finalDownloadUrl = backupUrl;
                            console.log('æ£€æµ‹åˆ°å›½å†…ç”¨æˆ·ï¼Œä½¿ç”¨å›½å†…å¤‡ç”¨ä¸‹è½½é“¾æ¥');
                        } else {
                            // å›½å¤–ç”¨æˆ·æˆ–æ— å¤‡ç”¨é“¾æ¥ï¼šç›´æ¥ä½¿ç”¨GitHub
                            finalDownloadUrl = asset.browser_download_url;
                            console.log('ä½¿ç”¨GitHubç›´æ¥ä¸‹è½½é“¾æ¥');
                        }

                        // è®¾ç½®ä¸‹è½½é“¾æ¥
                        downloadBtn.href = finalDownloadUrl;
                        downloadBtn.target = '_blank';
                        downloadBtn.rel = 'noopener noreferrer';

                        // å­˜å‚¨ä¸‹è½½ä¿¡æ¯åˆ°æŒ‰é’®æ•°æ®å±æ€§
                        downloadBtn.dataset.githubUrl = asset.browser_download_url;  // GitHubåŸå§‹é“¾æ¥
                        downloadBtn.dataset.backupUrl = backupUrl || '';  // å¤‡ç”¨é“¾æ¥ï¼ˆè“å¥äº‘ç­‰ï¼‰
                        downloadBtn.dataset.currentUrl = finalDownloadUrl;  // å½“å‰ä½¿ç”¨çš„é“¾æ¥
                        downloadBtn.dataset.filename = asset.name;

                        // æ·»åŠ æ™ºèƒ½ä¸‹è½½å¤„ç†
                        downloadBtn.addEventListener('click', function (e) {
                            // å¦‚æœæŒ‰ä½ Ctrl (Windows) æˆ– Cmd (Mac)ï¼Œå¼ºåˆ¶ä½¿ç”¨GitHubåŸå§‹é“¾æ¥
                            if (e.ctrlKey || e.metaKey) {
                                e.preventDefault();
                                const githubUrl = downloadBtn.dataset.githubUrl;
                                console.log('ç”¨æˆ·æŒ‰ä½Ctrl/Cmdï¼Œä½¿ç”¨ GitHub ç›´æ¥é“¾æ¥:', githubUrl);
                                window.open(githubUrl, '_blank', 'noopener,noreferrer');
                                return false;
                            }

                            // å¦‚æœæŒ‰ä½ Shiftï¼Œä¸”æœ‰å¤‡ç”¨é“¾æ¥ï¼Œä½¿ç”¨å¤‡ç”¨é“¾æ¥
                            if (e.shiftKey && downloadBtn.dataset.backupUrl) {
                                e.preventDefault();
                                const backupUrl = downloadBtn.dataset.backupUrl;
                                console.log('ç”¨æˆ·æŒ‰ä½Shiftï¼Œä½¿ç”¨å¤‡ç”¨ä¸‹è½½é“¾æ¥:', backupUrl);
                                window.open(backupUrl, '_blank', 'noopener,noreferrer');
                                return false;
                            }

                            // é»˜è®¤è¡Œä¸ºï¼šä½¿ç”¨å½“å‰è®¾ç½®çš„é“¾æ¥ï¼ˆå›½å†…ç”¨æˆ·=è“å¥äº‘ï¼Œå›½å¤–ç”¨æˆ·=GitHubï¼‰
                            console.log('ä½¿ç”¨é»˜è®¤ä¸‹è½½é“¾æ¥:', downloadBtn.dataset.currentUrl);
                        });

                        // æ·»åŠ å³é”®èœå•æç¤º
                        downloadBtn.addEventListener('contextmenu', function (e) {
                            // å³é”®èœå•ä¿æŒé»˜è®¤è¡Œä¸º
                            // ç”¨æˆ·å¯ä»¥é€‰æ‹©"åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥"ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                        });
                    } else {
                        throw new Error('No suitable download asset found for Windows.');
                    }
                }

                // é¦–å…ˆå°è¯•ä»ç¼“å­˜è·å–æ•°æ®
                const cachedData = getCache(cacheKey);
                if (cachedData) {
                    // å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œç›´æ¥ä½¿ç”¨
                    updateUIWithReleaseData(cachedData, windowsVersionInfo, windowsDownloadBtn);
                    return;
                }

                /**
                 * å°è¯•è·å–æ•°æ®çš„å†…éƒ¨å‡½æ•°
                 * @param {number} retriesLeft - å‰©ä½™é‡è¯•æ¬¡æ•°
                 * @param {number} delay - å½“å‰é‡è¯•çš„å»¶è¿Ÿæ—¶é—´
                 */
                function attemptFetch(retriesLeft, delay) {
                    fetch(apiUrl)
                        .then(response => {
                            if (!response.ok) {
                                // å¯¹äº 429 çŠ¶æ€ç ï¼ˆé€Ÿç‡é™åˆ¶ï¼‰ï¼Œæä¾›ç‰¹æ®Šå¤„ç†
                                if (response.status === 429) {
                                    return response.json().then(errorData => {
                                        const error = new Error(`Rate limit exceeded: ${errorData.message || 'API rate limit exceeded'}`);
                                        error.status = 429;
                                        error.retryAfter = errorData.retry_after || 60;
                                        throw error;
                                    });
                                }
                                // å¯¹äºå…¶ä»–é”™è¯¯çŠ¶æ€ç ï¼ŒæŠ›å‡ºé€šç”¨é”™è¯¯
                                throw new Error(`API error: ${response.status}`);
                            }
                            return response.json();
                        })
                        .then(data => {
                            // --- æˆåŠŸè·å–æ•°æ®åçš„å¤„ç†é€»è¾‘ ---
                            // ä¿å­˜åˆ°ç¼“å­˜
                            setCache(cacheKey, data);

                            // æ›´æ–°UI
                            updateUIWithReleaseData(data, windowsVersionInfo, windowsDownloadBtn);
                        })
                        .catch(error => {
                            // --- å¤±è´¥åçš„å¤„ç†é€»è¾‘ (æ ¸å¿ƒæ”¹åŠ¨) ---
                            console.error(`è·å– ${config.repoName} å¤±è´¥, å‰©ä½™é‡è¯•æ¬¡æ•°: ${retriesLeft - 1}. é”™è¯¯:`, error);

                            // å¯¹äºé€Ÿç‡é™åˆ¶é”™è¯¯ï¼Œä½¿ç”¨æ›´é•¿çš„å»¶è¿Ÿæ—¶é—´
                            let retryDelay = delay;
                            if (error.status === 429 && error.retryAfter) {
                                retryDelay = error.retryAfter * 1000; // è½¬æ¢ä¸ºæ¯«ç§’
                            }

                            if (retriesLeft > 1) {
                                // å¦‚æœè¿˜æœ‰å‰©ä½™é‡è¯•æ¬¡æ•°
                                const currentLang = document.documentElement.lang || 'zh';
                                let retryingTextZh, retryingTextEn;

                                if (error.status === 429) {
                                    retryingTextZh = `API è¯·æ±‚é¢‘ç‡è¶…é™, ${Math.ceil(retryDelay / 1000)}ç§’åé‡è¯•...`;
                                    retryingTextEn = `API rate limit exceeded, retrying in ${Math.ceil(retryDelay / 1000)}s...`;
                                } else if (error.status === 404) {
                                    retryingTextZh = `ä»“åº“æœªæ‰¾åˆ°, ${Math.ceil(retryDelay / 1000)}ç§’åé‡è¯•...`;
                                    retryingTextEn = `Repository not found, retrying in ${Math.ceil(retryDelay / 1000)}s...`;
                                } else {
                                    retryingTextZh = `è·å–å¤±è´¥, ${Math.ceil(retryDelay / 1000)}ç§’åé‡è¯•...`;
                                    retryingTextEn = `Failed, retrying in ${Math.ceil(retryDelay / 1000)}s...`;
                                }

                                // åœ¨ç•Œé¢ä¸Šæç¤ºç”¨æˆ·æ­£åœ¨é‡è¯•
                                windowsVersionInfo.textContent = (currentLang.startsWith('zh')) ? retryingTextZh : retryingTextEn;

                                // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨å»¶è¿Ÿç»“æŸåå†æ¬¡è°ƒç”¨ attemptFetch
                                setTimeout(() => {
                                    // ä¸‹ä¸€æ¬¡é‡è¯•æ—¶ï¼Œå‰©ä½™æ¬¡æ•°å‡1ï¼Œå»¶è¿Ÿæ—¶é—´åŠ å€ï¼ˆæŒ‡æ•°é€€é¿ç­–ç•¥ï¼‰
                                    const nextDelay = error.status === 429 ? retryDelay * 1.5 : delay * 2;
                                    attemptFetch(retriesLeft - 1, nextDelay);
                                }, retryDelay);
                            } else {
                                // å¦‚æœæ‰€æœ‰é‡è¯•æ¬¡æ•°éƒ½å·²ç”¨å°½ï¼Œåˆ™æ˜¾ç¤ºæœ€ç»ˆçš„é”™è¯¯ä¿¡æ¯
                                console.error(`è·å– ${config.repoName} åœ¨æ‰€æœ‰é‡è¯•åå‡å¤±è´¥.`);

                                let errorTextZh, errorTextEn, alertMessage;

                                if (error.status === 429) {
                                    errorTextZh = 'API é™é¢å·²ç”¨å®Œï¼Œè¯·ç¨åé‡è¯•';
                                    errorTextEn = 'API rate limit exceeded, please try again later';
                                    alertMessage = 'GitHub API è¯·æ±‚é™é¢å·²ç”¨å®Œã€‚\n\nå»ºè®®ï¼š\n1. è¯·1å°æ—¶åå†è¯•\n2. æˆ–è”ç³»ç®¡ç†å‘˜é…ç½® GitHub Token\n3. æˆ–è”ç³»å®¢æœè·å–æœ€æ–°ç‰ˆæœ¬';
                                } else if (error.status === 404) {
                                    errorTextZh = 'ä»“åº“ä¸å­˜åœ¨æˆ–æ— è®¿é—®æƒé™';
                                    errorTextEn = 'Repository not found or inaccessible';
                                    alertMessage = 'æ— æ³•æ‰¾åˆ°æ­¤è½¯ä»¶çš„å‘å¸ƒç‰ˆæœ¬ã€‚\n\nè¯·è”ç³»å®¢æœè·å–æœ€æ–°ç‰ˆæœ¬ã€‚';
                                } else {
                                    errorTextZh = 'è·å–å¤±è´¥, è¯·åˆ·æ–°æˆ–è”ç³»å®¢æœ';
                                    errorTextEn = 'Failed to fetch, please refresh or contact support';
                                    alertMessage = 'ç‰ˆæœ¬ä¿¡æ¯è·å–å¤±è´¥ï¼Œæ— æ³•ä¸‹è½½ã€‚\n\nå»ºè®®ï¼š\n1. åˆ·æ–°é¡µé¢é‡è¯•\n2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜\n3. è”ç³»å®¢æœè·å–æœ€æ–°ç‰ˆæœ¬';
                                }

                                windowsVersionInfo.setAttribute('data-lang-zh', errorTextZh);
                                windowsVersionInfo.setAttribute('data-lang-en', errorTextEn);
                                const currentLang = document.documentElement.lang || 'zh';
                                windowsVersionInfo.textContent = (currentLang.startsWith('zh')) ? errorTextZh : errorTextEn;

                                // ä¿®æ”¹ä¸‹è½½æŒ‰é’®çš„è¡Œä¸ºï¼Œä½¿å…¶ç‚¹å‡»æ—¶å¼¹å‡ºæç¤º
                                windowsDownloadBtn.onclick = (e) => {
                                    e.preventDefault();

                                    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨ä¸­å›½ï¼ˆé€šè¿‡æ—¶åŒºç²—ç•¥åˆ¤æ–­ï¼‰
                                    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                                    const isChina = timezone.includes('Asia/Shanghai') || timezone.includes('Asia/Beijing');

                                    // ä»…ä¸ºå›½å†…ç”¨æˆ·ä¸”æ˜¯æ”¯æŒçš„äº§å“æä¾›è“å¥äº‘å¤‡ç”¨ä¸‹è½½é“¾æ¥
                                    if ((isChina || navigator.language.includes('zh')) && (config.repoName === 'gogole_maps' || config.repoName === 'mediamingle_pro_repo' || config.repoName === 'email_validator_repo' || config.repoName === 'whatsapp_validator_repo')) {
                                        // æ ¹æ®ä¸åŒäº§å“è®¾ç½®ç›¸åº”çš„ä¿¡æ¯
                                        let backupUrl;
                                        if (config.repoName === 'gogole_maps') {
                                            backupUrl = 'https://small4.bakstotre.com/202512031421/956ebddd7933e704950e140553935dbe/disk/2025/12/03/23244306/11764742831329.rar?filename=GoogleMapsScraper-Setup.exe&fileId=12283959677&fileSize=198902&sUserId=12329699&tUserId=12329699&oUserId=23244306';
                                        } else if (config.repoName === 'mediamingle_pro_repo') {
                                            backupUrl = 'https://small4.bakstotre.com/202511201418/3400d6dca86119eff410e3164fe33a62/disk/2025/11/17/23244306/51763372457412.rar?filename=ProMailExtractor-Setup.exe&fileId=11682885132&fileSize=347255&sUserId=12329699&tUserId=12329699&oUserId=23244306';
                                        } else if (config.repoName === 'email_validator_repo') {
                                            backupUrl = 'https://small4.bakstotre.com/202511201419/59bc8c8a401fb4e1b9414df0291f8a36/disk/2025/11/17/23244306/91763372625244.rar?filename=MailPro.exe&fileId=11682887805&fileSize=143725&sUserId=12329699&tUserId=12329699&oUserId=23244306';
                                        } else if (config.repoName === 'whatsapp_validator_repo') {
                                            backupUrl = 'https://small4.bakstotre.com/202511201420/7972936f196c80a1b2c8980518ce4389/disk/2025/11/17/23244306/131763372830386.rar?filename=whatsapp-validator-setup-v1.0.1.exe&fileId=11682894883&fileSize=214922&sUserId=12329699&tUserId=12329699&oUserId=23244306';
                                        }

                                        if (backupUrl) {
                                            console.log(`æ£€æµ‹åˆ°å›½å†…ç”¨æˆ·ä¸”GitHub APIå¤±è´¥ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨ä¸‹è½½é“¾æ¥: ${config.repoName}`);
                                            // æ— æ„Ÿåˆ‡æ¢ï¼šç›´æ¥æ‰“å¼€å¤‡ç”¨é“¾æ¥
                                            window.location.href = backupUrl;
                                        } else {
                                            alert(alertMessage);
                                        }
                                    } else {
                                        alert(alertMessage);
                                    }
                                    return false;
                                };
                                // ç§»é™¤ href ä»¥é¿å…ä»»ä½•ä¸‹è½½å°è¯•
                                windowsDownloadBtn.href = 'javascript:void(0);';
                                // ç§»é™¤downloadå±æ€§
                                windowsDownloadBtn.removeAttribute('download');
                            }
                        });
                }

                // --- é¦–æ¬¡è°ƒç”¨ï¼Œå¼€å§‹è·å–æµç¨‹ ---
                attemptFetch(MAX_RETRIES, INITIAL_DELAY);
            }

            // --- ä¸ºä½ çš„æ¯ä¸ªäº§å“è°ƒç”¨ ---
            // ä»“åº“åç§°å¿…é¡»ä¸ GitHub ä¸Šçš„å®é™…ä»“åº“åç§°å®Œå…¨åŒ¹é…
            fetchProductRelease({ repoName: 'gogole_maps', windowsCardId: 'gs-windows-card', macosCardId: 'gs-macos-card' });
            fetchProductRelease({ repoName: 'email_validator_repo', windowsCardId: 'ev-windows-card', macosCardId: 'ev-macos-card' });
            fetchProductRelease({ repoName: 'whatsapp_validator_repo', windowsCardId: 'wv-windows-card', macosCardId: 'wv-macos-card' });
            fetchProductRelease({ repoName: 'mediamingle_pro_repo', windowsCardId: 'mm-windows-card', macosCardId: 'mm-macos-card' });
        });
    </script>
</body>

</html>